

configuration_etape_formulaire:

    choix-type-parapheur:
        name: Choix de la typologie parapheur
        type: text
        requis: true

    document_a_signer:
        name: Document à envoyer à la signature
        requis: true
        type: file

    annexe:
        name: Annexe(s) à envoyer à la signature
        type: multi_file

    co-signature:
        name: Fichier(s) de co-signature
        type: multi_file

    has-date-limite:
        name: Permettre l'utilisation d'une date limite
        type: checkbox



action:

  preparation-send-iparapheur:
    name: Préparation de l'envoi au parapheur
    rule:
      role_id_e: no-role
    action-automatique: send-iparapheur

  send-iparapheur:
    name-action: Transmettre au parapheur
    name: Transmis au parapheur
    rule:
      last-action:
        preparation-send-iparapheur
    action-class: StandardAction
    connecteur-type: signature
    connecteur-type-action: SignatureEnvoie
    connecteur-type-mapping:
      objet: libelle
      iparapheur_has_date_limite: has_date_limite
      iparapheur_date_limite: date_limite
      autre_document_attache: annexe
    action-automatique: verif-iparapheur

  verif-iparapheur:
    name-action: Vérifier le statut de signature
    name: Vérification de la signature
    rule:
      last-action:
        erreur-verif-iparapheur
        send-iparapheur
    action-class: StandardAction
    connecteur-type: signature
    connecteur-type-action: SignatureRecuperation
    connecteur-type-mapping:
      autre_document_attache: annexe

  erreur-verif-iparapheur:
    name: Erreur lors de la vérification du statut de signature
    rule:
      role_id_e: no-role

  recu-iparapheur:
    name: Signature récuperée
    rule:
      role_id_e: no-role
    editable-content:
      envoi_ged_1
      envoi_ged_2
    action-automatique: orientation

  rejet-iparapheur:
    name: Signature refusée
    rule:
      role_id_e: no-role
