#!/usr/bin/env php
<?php

/**
 * @var ObjectInstancier $objectInstancier
 */

use Pastell\Command\AddDefaultFrequencies;
use Pastell\Command\CreatePesViewerConnecteur;
use Pastell\Command\System\HealthCheckCommand;
use Pastell\Command\TruncateJournalHistorique;
use Symfony\Component\Console\Application;

if (false === in_array(PHP_SAPI, ['cli', 'phpdbg', 'embed'], true)) {
    echo 'Warning: The console should be invoked via the CLI version of PHP, not the ' . PHP_SAPI . ' SAPI' . PHP_EOL;
}

require dirname(__DIR__) . DIRECTORY_SEPARATOR . 'init.php';

// run the command application
$application = new Application();
$application->add($objectInstancier->getInstance(AddDefaultFrequencies::class));
$application->add($objectInstancier->getInstance(CreatePesViewerConnecteur::class));
$application->add($objectInstancier->getInstance(TruncateJournalHistorique::class));
$application->add($objectInstancier->getInstance(HealthCheckCommand::class));
$application->run();
