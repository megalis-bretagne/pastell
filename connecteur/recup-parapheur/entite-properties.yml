nom: Récupération dossiers iparapheur
type: recup-parapheur
description: Connecteur permettant de récupérer les dossiers en fin de circuit ou les dossiers à la corbeille d'un iparapheur >=v5

formulaire:
    page:
        url:
            name: URL du parapheur
            commentaire: "Exemple: https://iparapheur.partenaire.libriciel.fr"
        username:
            name: Nom d'utilisateur
        password:
            name: Mot de passe
            type: password
        tenant_id:
            name: Identifiant de l'entité iparapheur
            read-only: true
        tenant_name:
            name: Nom du l'entité iparapheur
            type: externalData
            choice-action: tenant_name
            link_name: 'Sélectionner le tenant'
#        type_id:
#            name: Identifiant du type parapheur
#            read-only: true
#        type_name:
#            name: Nom du type parapheur
#            type: externalData
#            choice-action: type_name
#            link_name: 'Sélectionner le type'
#        sous_type_id:
#            name: Identifiant du sous-type parapheur
#            read-only: true
#        sous_type_name:
#            name: Nom du sous-type parapheur
#            type: externalData
#            choice-action: sous_type_name
#            link_name: 'Sélectionner le type'
#        recup_type:
#            name: Type de récupération
#            type: select
#            value:
#                - Dossier en fin de circuit
#                - Dossier à la corbeille
#        bureau_id:
#            name: Identifiant du bureau à récupérer
#            commentaire: Utilisable uniquement pour les dossiers en fin de circuit
#            read-only: true
#        bureau_name:
#            name: Nom du bureau à récupérer
#            commentaire: Utilisable uniquement pour les dossiers en fin de circuit
#            type: externalData
#            choice-action: bureau_name
#            link_name: 'Sélectionner le bureau'
        pastell_module_id:
            name: Identifiant du type de dossier Pastell
            commentaire: Le dossier doit être un dossier studio. Par défaut, le type de dossier recup-parapheur est selectionné
            read-only: true
            default: ls-recup-parapheur
        pastell_module_name:
            name: Identifiant du type de dossier Pastell
            commentaire: Le dossier doit être un dossier studio. Par défaut, le type de dossier recup-parapheur est selectionné
            type: externalData
            choice-action: pastell_module_name
            link_name: 'Sélectionner le type de dossier'
        pastell_dictionnary:
            name: Correspondance des identifiants Pastell
            type: textarea
            commentaire: |
                Une ligne par correspondance de type: element: id_element_pastell
                élément à mettre en correspondance : dossier_id, dossier_name, document_signe, annexe, bordereau, premis
        nb_recup:
            name: Nombre de dossiers à récupérer et créer pour un passage du travail
            commentaire: 10 par défaut
            default: 10

action:
    tenant_name:
        action-class: TenantNameAction
        rule:
            internal-action: true

    type_name:
        action-class: TypeNameAction
        rule:
            internal-action: true

    sous_type_name:
        action-class: SousTypeNameAction
        rule:
            internal-action: true

    bureau_name:
        action-class: BureauNameAction
        rule:
            internal-action: true

    pastell_module_name:
        rule:
            internal-action: true
        action-class: StandardChoiceAction
        connecteur-type: utilities
        connecteur-type-action: GetModuleList
        connecteur-type-mapping:
            page_title: 'Choix du type de dossier'
            module_type: pastell_module_id
            module_type_label: pastell_module_name

    test_connexion:
        name: Tester la connexion
        action-class: RecupParapheurTestConnexion

    list_dossier:
        name: Lister les dossiers à récupérer
        action-class: RecupParapheurListDossier

    recup_one:
        name: Faire une boucle de récupération (synchrone)
        action-class: RecupParapheurRecupOne

    recup:
        name: Lancer la récupération (synchrone)
        action-class: RecupParapheurRecup
        action-automatique: recup

    recup-async:
        name: Lancer la récupération (asynchrone)
        action-class: RecupParapheurRecupAsync
