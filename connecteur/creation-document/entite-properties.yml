name: CreationDocument

description:| 
	Permet de récuperer un document ZIP via un connecteur de récupération.
	Le ZIP contient un fichier manifest.xml et/ou un fichier csv
	Le fichier manifest.xml contient : 
	<flux type='actes-generique'>
		<data name='objet' value='Achat de matériel'/>
		<data name='numero_de_lacte' value='20141023A'/>
		<data name='date_de_lacte' value='2015-01-17'/>
		[...]
		<files name='arrete'>
			<file content='fichier_contenant_lacte.pdf'>
		</files>
		<files name='autre_document_attache'>
			<file content='annexe1.pdf'>
			<file content='annexe2.jpg'>
		</files>
	</flux>
	Le fichier csv contient un en tête de colonne avec le nom des champs tel que définit dans le definition.yml du type de flux des documents à créer.
	Chaque ligne du fichier csv décrit un document à créer (suivant le type de flux en première colonne).
	Le ZIP contient également tous les fichiers défini dans le manifest.xml ou le csv (ex: fichier_contenant_lacte.pdf,annexe1.pdf,annexe2.jpg)
	Les fichiers sont détruit sur le serveur distant.
	Les données inconsistantes ou incomplètes sont ignorées.


type: CreationDocument

formulaire:
	CreationDocument:
		connecteur_recup:
			name: Connecteur de récupération
			type: externalData
			link_name: Liste des connecteurs de récupération
			choice-action: choix-recuperation
			
		connecteur_recup_id:
			no-show: true
			
		connecteur_auto:
			name: Récuperation automatique
			type: select
			value:
				0: non
				1: oui
		
		
action:	
	recuperation:
		name: Récupérer et créer les documents
		action-class: CreationDocumentRecup
		rule:
			droit_id_u: 'entite:edition'
		
	recuperation-auto:
		name: Tester le mode automatique
		no-workflow: true
		action-class: CreationDocumentRecupAuto
		rule:
			droit_id_u: 'entite:edition'
		action-automatique: recuperation-auto
		
		
	choix-recuperation: 
		name: Choix connecteur de récupération
		no-workflow: true
		rule:
			role_id_e: no-role
		action-class: CreationDocumentChoixRecuperation