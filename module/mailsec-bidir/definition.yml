nom: Mail sécurisé avec réponse

description: |
    Type de dossier permettant d'envoyer des mail sécurisés et de récupérer des réponses du destinataire

connecteur:
    mailsec

formulaire:
    Convocation:
        to:
            name: Destinataire(s)
            commentaire: Plusieurs emails possibles séparés par une virgule
            requis: true
            type: mail-list
            autocomplete: MailSec/getContactAjax
        cc:
            name: Copie à
            commentaire: Plusieurs emails possibles séparés par une virgule
            type: mail-list
            autocomplete: MailSec/getContactAjax
        bcc:
            name: Copie cachée à
            commentaire: Plusieurs emails possibles séparés par une virgule
            type: mail-list
            autocomplete: MailSec/getContactAjax
        password :
            name: Mot de passe
            type: password
            may_be_null: true
        password2 :
            name: Mot de passe (confirmation)
            type: password
            may_be_null: true
            is_equal: password
            is_equal_error: Les mots de passe ne correspondent pas
        objet:
            name: Objet
            requis: true
            title: true
        message:
            name: Message
            type: textarea
        document_attache:
            name: Document attaché
            type: file
            multiple: true
        key:
            no-show: true

        sent_mail_number:
            name: Destinataires
            default: '0'
            index: true
            no-show: true

        sent_mail_read:
            name: Mails lus
            default: '0'
            index: true
            no-show: true

        sent_mail_answered:
            name: Mails répondus
            default: '0'
            index: true
            no-show: true

champs-affiches:
    - titre
    - dernier_etat
    - date_dernier_etat
    - sent_mail_number
    - sent_mail_read
    - sent_mail_answered

action:
    creation:
        name-action: Créer
        name: Créé
        rule:
            no-last-action:
            droit_id_u: 'mailsec-bidir:edition'

    modification:
        name-action: Modifier
        name: En cours de rédaction
        rule:
            last-action:
                creation
                modification
            role_id_e: editeur
            droit_id_u: 'mailsec-bidir:edition'

    supression:
        name-action: Supprimer
        name: Supprimé
        rule:
            last-action:
                creation
                modification
                reception
                non-recu
                fatal-error
            role_id_e: editeur
            droit_id_u: 'mailsec-bidir:edition'
        action-class: Supprimer
        warning: "Êtes-vous sûr ?"

    envoi-mail:
        name: Mail envoyé
        name-action: Envoyer l'email
        rule:
            last-action:
                modification
            role_id_e: editeur
            droit_id_u: 'mailsec-bidir:edition'
            document_is_valide: true
        action-class: StandardAction
        connecteur-type: mailsec
        connecteur-type-action: MailsecEnvoyer

    reception:
        name: Mail reçu
        rule:
            role_id_e: no-role

    reception-partielle:
        name: Reçu partiellement
        rule:
            role_id_e: no-role

    renvoi:
        name-action: Envoyer à nouveau
        name: Renvoyé
        rule:
            last-action:
                envoi-mail
                reception-partielle
                reception
            role_id_e: editeur
            droit_id_u: 'mailsec-bidir:edition'
            document_is_valide: true
        action-class: StandardAction
        connecteur-type: mailsec
        connecteur-type-action: MailsecRenvoyer

    non-recu:
        name: Non reçu
        name-action: Définir comme non reçu
        warning: "ok"
        rule:
            last-action:
                envoi-mail
                renvoi
                reception-partielle
        action-class: Defaut

    compute_read_mail:
        name: Calcul des mails lus
        rule:
            role_id_e: no-role
        action-class: StandardAction
        connecteur-type: mailsec
        connecteur-type-action: MailsecComputeReadMail

    compute_answered_mail:
        name: Calcul des mails répondus
        rule:
            role_id_e: no-role
        action-class: StandardAction
        connecteur-type: mailsec
        connecteur-type-action: MailsecComputeAnsweredMail
